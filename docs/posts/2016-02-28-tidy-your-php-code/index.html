<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="1. 统一的编码规范 编码规范往简单说其实就是三个方面： 换行 空格 变量命名 放在 PHP 里面，还有一些附加的地方，比如关键字大小写，语法糖的使用（array" />
<meta name="keywords" content=", php" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://0x1.im/posts/2016-02-28-tidy-your-php-code/" />


    <title>
        
            PHP 代码规范简洁之道 :: Scholer&#39;s Pages 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.d1ea4af8fd04fb24a4f8b882ea54bd04eb245427ca4baf527c81a5dab071410b.css">






<meta itemprop="name" content="PHP 代码规范简洁之道">
<meta itemprop="description" content="1. 统一的编码规范 编码规范往简单说其实就是三个方面： 换行 空格 变量命名 放在 PHP 里面，还有一些附加的地方，比如关键字大小写，语法糖的使用（array"><meta itemprop="datePublished" content="2016-02-28T12:00:00+00:00" />
<meta itemprop="dateModified" content="2016-02-28T12:00:00+00:00" />
<meta itemprop="wordCount" content="1264">
<meta itemprop="keywords" content="php," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="PHP 代码规范简洁之道"/>
<meta name="twitter:description" content="1. 统一的编码规范 编码规范往简单说其实就是三个方面： 换行 空格 变量命名 放在 PHP 里面，还有一些附加的地方，比如关键字大小写，语法糖的使用（array"/>







    <meta property="article:published_time" content="2016-02-28 12:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://0x1.im" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">$</span>
            <span class="logo__text">echo 0x1.im</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://0x1.im/posts/">Posts</a></li><li><a href="https://0x1.im/tags/">Tags</a></li><li><a href="https://0x1.im/about/">About</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        3 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://0x1.im/posts/2016-02-28-tidy-your-php-code/">PHP 代码规范简洁之道</a>
      </h1>

      

      <div class="post-content">
        <h2 id="1-统一的编码规范">1. 统一的编码规范</h2>
<p>编码规范往简单说其实就是三个方面：</p>
<ol>
<li>换行</li>
<li>空格</li>
<li>变量命名</li>
</ol>
<p>放在 PHP 里面，还有一些附加的地方，比如关键字大小写，语法糖的使用（<code>array()</code> 与 <code>[]</code> 等）的问题。之前整理过 <a href="https://github.com/XiaoLer/php-develop-standards/blob/master/php-basic-coding-standard.md">PSR</a> 的标准，也找过 <a href="http://0x1.im/blog/php/php-cs-fixer.html">php-cs-fixer</a> 这样的工具。这些都是规范代码的重要手段。有统一的标准，配合上工具的检查，形成统一的编码约束不是什么难题。</p>
<p>没有规范，不同的人甚至同一个人在空格、换行和命名上都有可能是十分随意的。代码一长，回使整个文件看起来无比杂乱。</p>
<p>典型的例子比如：<code>if</code> 和 <code>else</code> 的组合，可以写出无数种风格，比如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1"># 单语句不写大括号
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="nx">doSomething</span><span class="p">();</span>
<span class="c1"># else 大括号换行 十分占篇幅
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nx">doSomething</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="nx">doElseThings</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1"># 此外还有关键字后不带空格，随意缩进等等
</span><span class="c1"># ...
</span></code></pre></div><p>再比如变量函数命名的问题上，各种混搭风格层出不穷：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1"># 全小写
</span><span class="c1"></span><span class="nv">$someparam1</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="c1"># 首字母下环线
</span><span class="c1"></span><span class="nv">$_some_param_1</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
<span class="c1"># 某些库的类，下划线和大小写混用
</span><span class="c1"></span><span class="k">class</span> <span class="nc">Abstract_ClassA</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div><p>这里并不探讨各种写法的优缺点，只是风格需要保持统一，不要混用。</p>
<h2 id="2-良好的编码习惯">2. 良好的编码习惯</h2>
<p>如果你仔细看过 PSR 的标准，可能也会注意到某些地方其实是标准无法涉及到的。比如一个超长的表达式在什么时候换行，如何缩进等。</p>
<p>这里涉及到的就是编码习惯的约束问题。</p>
<p>比如方法的链式的调用的问题，比如某些数据库查询的封装：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="c1"># 不换行的情况下句子会很长
</span><span class="c1"></span><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">result</span><span class="p">();</span>

<span class="c1"># 这种情况下我建议是一个条件一行，保持缩进
</span><span class="c1"></span><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">select</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">groupBy</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">orderBy</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;DESC&#39;</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">result</span><span class="p">();</span>
</code></pre></div><p>还有数组定义，某些数组成员字符串很长的情况下的写法：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;abcdefg&#39;</span><span class="p">,</span> <span class="s1">&#39;acbdfeg&#39;</span><span class="p">,</span> <span class="s1">&#39;bcadgfe&#39;</span><span class="p">,</span> <span class="s1">&#39;cdadgef&#39;</span><span class="p">];</span>

<span class="c1"># 如果成员太长，我建议拆解，这样
</span><span class="c1"></span><span class="nv">$array</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;abcdefg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;acbdfeg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bcadgfe&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cdadgef&#39;</span><span class="p">,</span>
<span class="p">];</span>
</code></pre></div><h2 id="3-寻找最优的写法">3. 寻找最优的写法</h2>
<p>写代码的过程中，最优的写法和编码习惯又不是同一件事情。这里要说的指的是如何遵循 PHP 的语言特性或者框架的特征，充分发挥语言和框架的能力来减少冗余。</p>
<p>比如在获取前端传入的参数的时候，很多时候能见到这样的代码：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="o">&lt;?</span><span class="nx">php</span>
<span class="nv">$param</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</code></pre></div><p>更有甚者一些框架将前端传入的参数封装了一层，比如 <code>$this-&gt;request-&gt;data['param']</code>，如果再去用 <code>isset</code> 或者 <code>array_key_exists</code> 判断，整个获取参数的语句就会变得很长。</p>
<p>某些情况下使用三元运算符的时候需要注意 <code>?:</code> 是可以<a href="http://0x1.im/blog/php/add-a-operator-to-php7.html">合并使用</a>的。</p>
<p>其实我们应该去尝试封装这种写法，防止同样的变量出现在一个语句中多次的情况。对于默认值的赋予，可以调研框架是否有封装提供，或者通过强制类型转换的方式进行。</p>
<p>还有一种情况是条件和循环嵌套的时候。比如从数组里抽取某一个字段，或者对某一个字段的值进行处理的时候，善用 <code>array_map</code> 以及引用（<code>&amp;</code>）往往能节省不少工作量。但是使用的时候也要注意数组指针最后的位置。</p>
<p>在根据条件返回结果时，需要善用 <code>return</code>。还有就是合理的抽象与封装。</p>
<h2 id="4-review-自己的代码">4. review 自己的代码</h2>
<p>除了以上提到的在日常开发中需要注意的一些问题。还有就是事后的工作。</p>
<p>我相信很多人在看自己以前的代码的时候都有一种其实有更好的写法的感觉。随着时间的推移自己总会有更丰富的阅历，更多的想法。偶尔 review 自己的代码也是对过去的总结，也许会有新的感知。</p>
<h2 id="5-推广给你的队友">5. 推广给你的队友</h2>
<p>团队项目中，队友的配合对整个代码的规范起着决定性的作用。一个团队中有一个人不遵守规范，而又要到处修改代码的时候，很快就能破坏到所有的约束。</p>
<p>有统一的标准，有良好的执行力才能完成这件工作。</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
        <p>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon">
            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
            <line x1="7" y1="7" x2="7" y2="7"></line>
          </svg><span class="tag"><a href="https://0x1.im/tags/php/">php</a></span>
        </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1264 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        2016-02-28 20:00
      </p>
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://0x1.im/posts/2016-05-01-php-use-shared-memory/">
                <span class="button__icon">←</span>
                <span class="button__text">PHP 共享内存使用与信号控制</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://0x1.im/posts/2015-12-31-hello-2016/">
                <span class="button__text">Googbye 2015 &amp; Hello 2016</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            
            <span></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.a0f363fdf81cdc5cfacc447a79c33189eb000d090336cd04aac8ee256f423b3133b836c281944c19c75e38d0b0b449f01ce5807e37798b7ac94ac1db51983fc4.js" integrity="sha512-oPNj/fgc3Fz6zER6ecMxiesADQkDNs0EqsjuJW9COzEzuDbCgZRMGcdeONCwtEnwHOWAfjd5i3rJSsHbUZg/xA=="></script>



    </body>
</html>
